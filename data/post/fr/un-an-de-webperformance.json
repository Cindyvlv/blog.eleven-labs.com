{"date":"2019-03-06T00:00:00.000Z","title":"Un an de webperformance dans un média français","excerpt":"Depuis un an je travaille en tant qu'expert webperformance chez France Medias Monde dans le cadre de la refonte de l'ensemble des fronts des différents sites web du groupe. Nous allons revenir sur cette expérience, pour nous permettre de comprendre comment réaliser ce genre de mission.","readingTime":"6mn","authors":["captainjojo"],"categories":[],"content":"\nDepuis un an je travaille en tant qu'expert webperformance chez France Media Monde dans le cadre de la refonte de l'ensemble des fronts des différents sites web du groupe. Nous allons revenir sur cette expérience, pour nous permettre de comprendre comment réaliser ce genre de mission.\n\n## Brief\n\nFrance Medias Monde c'est trois gros sites publics [MCD](https://www.mc-doualiya.com/), [RFI](http://www.rfi.fr/) et [France24](https://www.france24.com/fr/).\n\nLes sites sont principalement utilisés en version mobile sur des réseaux 3g voire edge.\n\nAujourd'hui, l'ensemble des sites médias se fait concurrence sur les infos dites `chaudes`, c'est à dire les infos en direct. En effet, tout le monde veut récupérer les utilisateurs lors d'une nouvelle info, et pour cela il faut être l'un des premiers à remonter sur Google. On sait aujourd'hui que le calcul de la position dans la recherche Google prend en compte la performance du site en version mobile avec peu de réseau. Le but est donc d'être meilleur que les autres sites pour être le premier à apparaitre.\n\nIl n'y a pas que pour l'actu chaude que la performance du site est importante. On le sait aujourd'hui, il existe clairement un impact fort entre le trafic du site et la web performance. Je vous invite à lire [ce document](https://www.thinkwithgoogle.com/marketing-resources/data-measurement/mobile-page-speed-new-industry-benchmarks/) provenant d'une source plutôt fiable puisqu'il s'agit de Google.\n\n![thinkwithgoogle]({{site.baseurl}}/assets/2019-02-28-un-an-de-webperformance/image1.jpg)\n\nVoici trois points qui vous donneront envie de faire de la webperformance :\n\n- Votre taux de pages vues par visite augmente\n    - +1 seconde de temps de chargement = – 11% de pages vues.\n- Vous diminuez votre taux de rebond\n    - -7% sur le taux de rebond grâce à un site rapide\n- Vous sauvez la vie des ours polaires\n    - moins de requêtes = moins d’énergie. En un sens, vous agissez pour l’environnement !\n\nSource : [https://www.fasterize.com/fr/blog/15-raisons-de-penser-webperf/](https://www.fasterize.com/fr/blog/15-raisons-de-penser-webperf/)\n\nDans le cadre de la refonte de l'ensemble des sites, France Média Monde voulait donc suivre les indicateurs de performance afin de devenir numéro un sur le mobile.\n\n## Choisir les métriques\n\nLe choix des métriques est très important pour le suivi de la webperformance.\nPrenons quelques exemples de métriques importantes :\n\n- *Page Load* : le temps que met la page à se charger\n- *Fully Loaded* : le temps que met la page pour ne plus avoir d’activités réseaux (2 secondes sans activité)\n- *First Byte* : le temps que met le premier Byte à être récupéré par le navigateur\n- *Speed Index* : métrique calculée qui permet de connaître la perception de l’affichage pour l’utilisateur (elle utilise plusieurs métriques)\n\nBien sûr il n'est pas possible de suivre l'ensemble des métriques et cela n'aurait pas de sens. Souvent réduire une métrique aura un impact négatif sur une autre et inversement. Nous avons donc besoin de choisir nos KPIs dès le début du projet et de ne plus changer.\n\nDans le cadre de la mission nous avons choisi cinq KPIs à suivre. L'un des plus important est le visuel d'une page seconde par seconde (filmstrips), cela permet de comprendre ce que voit l'utilisateur. Comme la webperformance n'a pas de valeur absolue, il est préférable de faire un benchmark avec vos concurrents. C'est certainement ce qui est le plus important, car Google compare les résultats entre les sites.\n\n![filmstrips]({{site.baseurl}}/assets/2019-02-28-un-an-de-webperformance/image2.png)\n\nMaintenant que nous savons quelles sont les métriques à suivre, nous pouvons choisir le ou les outils pour les suivre.\n\n## Suivre les métriques\n\nLes métriques doivent être présentes dans plusieurs étapes du développement. Tout d'abord, nous devons pouvoir suivre les métriques durant le développement, ainsi que dans une CI.\n\nNous avons choisi [Sitespeed.io](https://www.sitespeed.io/), qui est une suite d'outillage sur Docker que vous pouvez insérer dans votre CI ou installer sur vos postes.\n\nSitespeed utilise les résultats de [WebPageTest](https://www.sitespeed.io/documentation/sitespeed.io/webpagetest/) et les pose dans un [ELK](https://www.elastic.co/fr/elk-stack). Cela nous permet de mettre en place des boards personnalisés permettant de voir en un instant nos KPIs.\n\nLes équipes de développement peuvent aussi utiliser la console Chrome qui contient de nombreux outils permettant de suivre la webperformance.\n\nComme par exemple :\n\n- **audit** permettant de faire un rapport de webperformance\n\n![audit]({{site.baseurl}}/assets/2019-02-28-un-an-de-webperformance/image3.png)\n\n- **network** permettant de voir les bottlenecks du réseau\n- **coverage** permettant de connaitre le taux d'utilisation du javascript et du css\n\n![coverage]({{site.baseurl}}/assets/2019-02-28-un-an-de-webperformance/image4.png)\n\n## Travailler avec les équipes\n\nUne fois l'ensemble des métriques et des outils choisis, il faut travailler avec les équipes sur les sujets de fond.\n\nNous avons choisi avec France Media Monde de faire cela en plusieurs étapes.\n\nComme la refonte utilisera Vue.js, nous avons tout d'abord travaillé sur l'architecture et la performance de l'application javascript. Dès le début du projet, nous avons donc travaillé avec les équipes pour mettre en place la meilleure architecture possible.\n\nLa première chose que nous avons mise en place c'est un manifeste de la webperformance à destination de l'ensemble des équipes. Ce sert aux designers, aux développeurs, aux product owners et à l'infrastructure. Son but est de permettre de prendre les décisions en pensant aussi à la webperformance. Cela permet de ne plus intervenir en mode pompier, donc de ne plus attendre qu'il y ait des problèmes pour agir, mais d'ssurer un suivi tout au long du run.\n\nNous avons mis en place avec l'équipe des vérifications lors des builds de l'application. Cela nous permet de valider tout le long du développement que la webperformance est correcte et suit nos KPIs.\n\nDepuis, je passe du temps avec les équipes afin de donner des recommandations selon l'avancement des développements. En effet, le principe de la webperformance, c'est de procéder étape par étape. Il faut que chaque développement suive les recommandations webperf et que l'ajout de nouvelles fonctionnalités ne l'entrave pas.\n\nEn un an, nous avons mis en place de nombreuses choses permettant d'améliorer la webperformance. Je vais vous donner quelques tips pour vos sites.\n\n## Les tips\n\n- Le passage en **HTTPS/HTTP2** est une moyen simple d'améliorer la performance de votre site. Le coût de vos requêtes HTTP sera amélioré\n- **Compresser** vos réponses HTML en Gzip pour vous permettre de gagner sur le download surtout en 3G\n- **Minimize** les CSS et JS toujours dans un souci de gain de place dans vos requêtes HTTP\n- Utiliser les **defer** pour ne plus bloquer l'affichage de la page\n- Mettre en place des **preconnect**, **preload** et **prefetch** pour que votre navigateur se connecte aux ressources externes plus rapidement\n- Etc...\n\nCe qui est important c'est de suivre les nouveautés en lien avec la webperformance. Google met très souvent du contenu en ligne pour expliquer les nouveaux outils mis en place pour nous permettre de rendre nos applications toujours plus performantes.\n\nVoici un exemple fait à la google I/O 2018\n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/Mv-l3-tJgGk\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n\n## Bilan\n\nAprès un an de mission et grâce au travail des équipes MCD et France24, nous sommes maintenant numéro un selon nos métriques. Comme un long discours ne sert à rien voici le résultat après la mise en production.\n\n![bilan]({{site.baseurl}}/assets/2019-02-28-un-an-de-webperformance/image5.png)\n\n![bilan]({{site.baseurl}}/assets/2019-02-28-un-an-de-webperformance/image6.png)\n\n![bilan]({{site.baseurl}}/assets/2019-02-28-un-an-de-webperformance/image7.png)\n\n![bilan]({{site.baseurl}}/assets/2019-02-28-un-an-de-webperformance/image8.png)\n\n\nSi vous aussi vous souhaitez améliorer votre webperformance, renseignez-vous [ici](https://eleven-labs.com/accompagnement-sur-mesure/audit-et-expertise)\n"}